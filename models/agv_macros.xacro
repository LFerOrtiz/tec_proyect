<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/xacro">

    <!-- ************************ Create wheels ************************ -->
    <xacro:macro name = "wheelz" params = "name parent mass radius leng origin_xyz">
        <link name="${name}_wheel">
            <inertial>
                <origin xyz = "0 0 0" rpy="0 1.5707 1.5707" />
                <mass value="${mass}"/>
                <inertia ixx="${mass * (3*radius*radius+(leng*leng))/12}" ixy="0" ixz="0"
                         iyy = "${mass * (3*radius*radius+(leng*leng))/12}" iyz="0" 
                         izz = "${mass * (radius*radius)/2}" />
            </inertial>

            <visual>
                <origin xyz="0 0 0" rpy="0 1.5707 1.5707" />
                <geometry>
                    <cylinder length="${leng}" radius="${radius}"/>
                </geometry>
                <material name="Black"/>
            </visual>

            <collision>
                <origin xyz = "0 0 0" rpy="0 1.5707 1.5707" />
                <geometry>
                    <cylinder length="${leng}" radius="${radius}"/>
                </geometry>
                
                <surface>
                    <friction>
                        <kp>1000000.0</kp> <!-- kp and kd for rubber -->
                        <kd>1.0</kd>
                        <mu1>1.0</mu1>    <!-- Coulomb friction mus-->
                        <mu2>1.0</mu2>  <!-- Friction coefficient muk-->
                        <fdir1>1 0 0</fdir1>
                        <slip1>0.0</slip1>
                        <slip2>0.0</slip2>
                        <maxVel>10.0</maxVel>
                        <minDepth>0.001</minDepth>
                    </friction>
                </surface>
            </collision>
        </link>

        <joint name="${name}_wheel_joint" type="continuous">
            <origin xyz="${origin_xyz}" rpy="0 0 0" />
            <child link="${name}_wheel"/>
            <parent link="${parent}"/>
            <axis xyz="0 1 0" rpy="0 0 0"/>
            <limit effort="100" velocity="5.0"/>
            <joint_properties damping="0.7"/>
        </joint>
    </xacro:macro>
</robot>